<div class="container mt-5">
    <div class="card shadow border-0 rounded-4 mx-auto" style="max-width: 700px;">
        <div class="card-header bg-white border-0 pt-4 px-5">
            <h4 class="fw-bold text-primary">Agendar Cita Médica</h4>
            <div class="progress mt-3" style="height: 5px;">
                <div class="progress-bar" [style.width.%]="(currentStep/3)*100"></div>
            </div>
            <p class="text-muted small mt-2">Paso {{currentStep}} de 3</p>
        </div>

        <div class="card-body p-5">
            <form [formGroup]="agendarForm">
                
                <div *ngIf="currentStep === 1">
                    <h5 class="mb-4">Seleccione la modalidad</h5>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="card h-100 text-center p-3 border-2 cursor-pointer hover-shadow" 
                                 (click)="selectModalidad('PRESENCIAL')"
                                 [class.border-primary]="agendarForm.get('modalidad')?.value === 'PRESENCIAL'">
                                <i class="bi bi-hospital fs-1 text-primary mb-2"></i>
                                <p class="fw-bold">En Consultorio</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card h-100 text-center p-3 border-2 cursor-pointer hover-shadow"
                                 (click)="selectModalidad('VIRTUAL')"
                                 [class.border-primary]="agendarForm.get('modalidad')?.value === 'VIRTUAL'">
                                <i class="bi bi-camera-video fs-1 text-info mb-2"></i>
                                <p class="fw-bold">Virtual</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card h-100 text-center p-3 border-2 cursor-pointer hover-shadow"
                                 (click)="selectModalidad('DOMICILIO')"
                                 [class.border-primary]="agendarForm.get('modalidad')?.value === 'DOMICILIO'">
                                <i class="bi bi-house-door fs-1 text-success mb-2"></i>
                                <p class="fw-bold">A Domicilio</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="currentStep === 2">
                    <h5 class="mb-3">Detalles de la Cita</h5>
                    
                    <div class="mb-3">
                        <label for="fechaHora" class="form-label">Fecha y Hora</label>
                        <input type="datetime-local" id="fechaHora" class="form-control" formControlName="fechaHora">
                    </div>

                    <div class="mb-3">
                        <label for="motivo" class="form-label">Motivo de consulta</label>
                        <textarea id="motivo" class="form-control" rows="3" formControlName="motivoConsulta" placeholder="Describa sus síntomas..."></textarea>
                    </div>

                    <div class="row">
                        <div class="col-6">
                            <label for="peso" class="form-label">Peso (kg)</label>
                            <input type="number" id="peso" class="form-control" formControlName="peso" placeholder="Ej: 70.5">
                        </div>
                        <div class="col-6">
                            <label for="altura" class="form-label">Altura (m)</label>
                            <input type="number" id="altura" class="form-control" formControlName="altura" placeholder="Ej: 1.75">
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <button type="button" class="btn btn-secondary" (click)="prevStep()">Atrás</button>
                        <button type="button" class="btn btn-primary" (click)="nextStep()" [disabled]="agendarForm.get('fechaHora')?.invalid">Siguiente</button>
                    </div>
                </div>

                <div *ngIf="currentStep === 3">
                    <h5 class="mb-3 text-center">Resumen de la Cita</h5>
                    
                    <div class="alert alert-light border">
                        <p><strong>Modalidad:</strong> {{ agendarForm.get('modalidad')?.value }}</p>
                        <p><strong>Fecha:</strong> {{ agendarForm.get('fechaHora')?.value | date:'medium' }}</p>
                        <p><strong>Médico:</strong> Dr. House (Neurología)</p>
                        <p><strong>Motivo:</strong> {{ agendarForm.get('motivoConsulta')?.value }}</p>
                    </div>

                    <div class="d-grid gap-2 mt-4">
                        <button type="button" class="btn btn-success btn-lg" (click)="submit()">
                            Confirmar y Agendar
                        </button>
                        <button type="button" class="btn btn-link text-secondary" (click)="prevStep()">Volver</button>
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>